# https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html
# 字段是 workflow 的名称。如果省略该字段，默认为当前 workflow 的文件名。
name: MAIN CICD

# 触发条件
on:
  push:
    branches: [ master ]
#  pull_request:
#    branches: [ master ]

# 执行一个或者多个任务
jobs:
  build:
    runs-on: ubuntu-18.04 # runs-on字段指定运行所需要的虚拟机环境
    strategy:
      max-parallel: 4
      matrix:
        python-version: [3.9]

    steps: # 字段指定每个 Job 的运行步骤
    - name: checkout to masater
      uses: actions/checkout@master
    - name: Set up Python ${{ matrix.python-version }} # 步骤名称
      uses: actions/setup-python@v1
      with:
        python-version: ${{ matrix.python-version }}
    # 建立环境
    - name: Install Dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r ./requirements.txt
    # 运行测试
    - name: Run Tests
      run: |
        python -m pytest -v
